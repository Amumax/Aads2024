## Персистентность
**Персистентная версия** Для структуры S назовем ее персистентной версией такую
структуру pers(S), что ее интерфейс совпадает с интерфейсом S и
имеется операция rollback(k) — возможность откатываться к версии
на момент k-го запроса изменения.

**Частично персистентная структура** если результат rollback(k)
дает read-only структуру.

**Структура полностью персистентная**, если результат rollback(k)
дает доступ на изменение.

Как можно заметить, частично персистентные структуры имеют
граф версий в виде дерева, тогда как полностью персистентные —
DAG версий. (В одну версию можно прийти из разных)

## Персистентный стек
1. Храним стек как список, т.е. каждый элемент знает кто был предыдущим. (Самый первый на nullptr или на одну пустую вершину). Вся структура имеет вид дерева.
2. Поддерживаем массив версий. В i-ой ячейке ссылка на голову стека в момент версии i. И текущую версию в cur_version
3. Push(v) добавляем нового ребенка к голове текущей версии (в ребенка кладем указатель на родителя), и в массив версий добавляем указатель на вновь добавленную вершину
4. Pop() переходим в голову текущей версии и в ее родителя (предыдущий элемент). Теперь он являетс головой новой версии. Добавим в массив версий указатель на него. При этом ребенка не удаляем. Вообще ничего не удаляем
## Полностью персистентное дерево отрезков
### Идея
1. Будем хранить дерево отрезков как настоящее дерево. Храним указатель на корень и в каждой node'е указатели на детей
2. Будем хранить массив корней деревьев отрезков.
3. При запросе обновления старой версии будем порождать новый корень и новую ветку.
4. В новой ветке немодифицированные дети ссылаются на узлы в прошлой версии. А для тех, которые будем модифицировать -- создаем копии

### Корректность 
- Поскольку копируются только узлы вдоль измененного пути, а неизмененные части разделяются, свойства ДО сохраняются в каждой версии.
- Так как у каждой версии есть отдельный корень, нет пересечения между версиями.

### Что по асимптотике?
За каждое добавление/удаление создается новый копированный путь, поэтому в худшем случае требуется $O(\log{N})$ дополнительного пространства и собственно потратим $O(\log{N})$ времени на спуск от корня до листа. Но при этом высота дерева не меняется. Так что поиск работает так же за $O(\log{N})$
